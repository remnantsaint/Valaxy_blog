---
layout: post
title: ACDC-NN-Seq 文献精读
date: 2025-10-22 12:09:15
updated: 2025-10-22
time_warning: true 
cover: 
top: 
tags: 
 - ddg
categories: 
 - 生物信息
# author: @Remsait
---
# 一种基于深度学习序列的方法来预测蛋白质稳定性在遗传变异后的变化
  [A Deep-Learning Sequence-Based Method to Predict Protein Stability Changes Upon Genetic Variations](https://doi.org/10.3390/genes12060911)
## 摘要
  多项研究已将蛋白质稳定性及其正常功能的破坏与疾病联系起来。因此，在过去的几十年中，已开发出许多工具来预测蛋白质残基变异后的自由能变化。这些方法大多需要序列和结构信息才能获得可靠的预测结果。然而，由于实验上的困难，可用的蛋白质结构数量远少于其序列数量，这极大地限制了这些工具的应用。此外，当前的方法忽略了表征蛋白质稳定性热力学特性的反对称性质：蛋白质从野生型变为突变型（$X_W → X_M$）与其逆向过程（$X_M → X_W$）的自由能变化值必须互为相反数（∆∆$G_{WM}$= −∆∆$G_{MW}$）。在此，我们提出了ACDC-NN-Seq，这是一种利用序列信息的深度神经网络系统，其架构能够融入反对称性质。据我们所知，这是首个仅依赖蛋白质序列来预测蛋白质稳定性变化的卷积神经网络。我们证明，ACDC-NN-Seq的表现优于现有的基于序列的预测方法。
## 引言
  预测遗传变异对蛋白质稳定性的影响仍然是一个尚未解决的挑战。理解氨基酸序列改变的影响至关重要，这些改变主要源于非同义（或错义）DNA变异，可能导致蛋白质活性的破坏或增强，从而影响人类健康和疾病。特别是，蛋白质稳定性的扰动已被证实与致病性错义变异相关，并被证明会促成单倍剂量不足基因的功能丧失。

  氨基酸序列变异引起的蛋白质稳定性变化通常用解折叠吉布斯自由能变化（∆∆G）来表示，其定义为突变蛋白质结构与野生型结构能量之差（∆∆G = ∆$G_M$ − ∆$G_W$）。热力学对∆∆G施加了一种反对称关系，可总结如下：给定野生型（W）和突变型（M）的蛋白质结构，二者仅在位置X的一个残基上不同，量∆∆$G_{WM}$=（∆$G_W$ − ∆$G_M$）表示由氨基酸替换$X_W$ → $X_M$引起的蛋白质稳定性变化。同样，鉴于M和W这两个分子系统之间的对称性，对于逆向变化$X_M$ → $X_W$，相应的吉布斯自由能变化符号相反：$\Delta\Delta G_{WM} = -\Delta\Delta G_{MW}$

  由于实验测定∆∆G是一项耗时且复杂的任务，因此在过去几十年中，已开发出多种计算工具来预测∆∆G值。一些方法基于结构，需要已知蛋白质的三级结构；另一些方法基于序列，仅依赖蛋白质序列，或在结构可用时选择性地加以利用。然而，这些方法中的大多数都违背了反对称性质，在预测逆向变异时存在较大偏差。为解决这一问题，我们近期提出了ACDC-NN，这是一种新颖的基于结构的方法，它满足反对称的物理特性，同时性能达到当前先进方法的水平。然而，蛋白质结构的实验测定及其热力学特性的表征仍然有限，而近年来随着基因组和宏基因组测序工作的扩展，蛋白质序列数据库则大幅增长。UniProtKB/TrEMBL蛋白质数据库的最新版本共包含214,406,399条序列条目，其中包括175,817个人类蛋白质；而蛋白质数据库（Protein Data Bank）仅有177,655个条目，其中人类蛋白质为52,485个。因此，亟需能够仅利用序列信息来预测遗传变异对蛋白质稳定性影响的计算方法。为此，我们开发了ACDC-NN-Seq，这是ACDC-NN的基于序列的版本。与前代方法类似，它无需蛋白质三级结构即可实现满足反对称性质的高精度预测。本文表明，ACDC-NN-Seq在性能上与现有的基于序列和基于结构的方法均具有良好的可比性。我们在一个无偏数据集上检验了预测结果的反对称性，并在三种具有临床意义的蛋白质上评估了其准确性，同时通过过滤掉序列相似性高于25%的数据以避免过拟合。
## 材料与方法
### 数据集和交叉验证
  由于应用深度学习技术需要大量数据才能达到最佳性能，我们使用另一种方法DDGun3D的预测结果对ACDC-NN-Seq进行了预训练。DDGun3D已被证明在实现反对称性的同时具有良好的预测性能。DDGun3D并未在实验数据上进行训练，而是基于进化信息和统计势函数。预训练阶段在一个由Ivankov数据集生成的人工变异集上进行，我们将其命名为IvankovDDGun。该数据集的∆∆G值由DDGun3D计算得出，并由ACDC-NN-Seq学习这些得分。

  为了训练和测试网络，我们采用了ProTherm数据库中一些最常用数据集所报告的实验观测∆∆G变异数据，这些数据集已针对该数据库中已知存在的冗余和不准确问题进行了清理，包括S2648和Varibench。ACDC-NN-Seq的性能在以下数据集上进行了测试：Ssym、p53、肌红蛋白（myoglobin）以及CAGI5挑战赛中的frataxin突变体。这些数据集汇总于表1中，其详细描述可参见我们之前的研究（ACDC-NN）。
  ![](https://cloudflare.remsait.com/img/ACDC-NN-SEQ202510221334095.png)
  由于这些数据集通常包含序列相似度较高的蛋白质，为了避免由此引起的过拟合问题，我们采用与ACDC-NN相同的方法，过滤掉序列相似性高于25%的样本。我们使用blastclust算法生成交叉验证折（cross-validation folds），以创建序列同一性低于25%的蛋白质簇（命令：blastclust -i infile.fasta -o out.clusters -p T -L 0.5 -b F -S 25）。
### 序列谱
  ACDC-NN-Seq 使用从多序列比对中获得的进化信息。通过比对可以得到一个序列谱（profile），即一个 N × 20 的矩阵，其中每个元素 Prof(i,j) 表示第 j 种氨基酸残基在第 i 个序列位置上的出现频率。N 代表蛋白质的长度，20 代表 20 种不同的氨基酸残基。多序列比对使用 Uniprot 数据库（2016 年版本）并通过 hhblits 工具以默认参数计算得到。
### ACDC-NN-Seq 网络架构
  ACDC-NN-Seq 的架构是此前已发表的基于三维结构版本（3D version）的序列对应版本。此处我们仅介绍相关要点，省略部分数学细节。

  ACDC-NN-Seq 是一种反对称卷积差分拼接神经网络（Antisymmetric Convolutional Differential Concatenated Neural Network, ACDC-NN），它同时接收正向和逆向变异作为输入，通过卷积操作进行处理，然后将提取的特征作为两个孪生神经网络（siamese neural networks）的输入。具体而言，ACDC-NN-Seq 的每个输入由 160 个元素组成，用于编码变异信息和序列的进化信息：
  *  变异信息 (V)：20 个特征（每种氨基酸对应一个），用于编码变异。该特征向量中所有元素初始化为 0，仅将野生型氨基酸位置设为 -1，突变后氨基酸位置设为 1。此输入对应一个维度为 R²⁰×¹ 的一维矩阵 V；
  *  序列信息 (S 或 1D 输入)：140 个特征，表示变异位点周围的蛋白质序列谱信息。设 i 为序列中的突变位置，我们采用一个包含 3 个残基的滑动窗口 [i − 3; i + 3]，从而得到 20 × 7 = 140 个元素，即这 7 个位置上的序列谱信息。因此，该输入对应于从蛋白质序列谱中提取的 7 个向量组成的序列。

  在 S 矩阵上应用了一个二维卷积层，卷积核大小为 (1, 20)，步长为 (1, 1)（采用 Keras 风格的参数表示），生成一个 20 × 20 的滤波矩阵 KS。卷积操作后，将变异向量 V 与得到的二维卷积矩阵进行点积运算，从而为正向变异及其逆向变异分别生成 7 个处理后的特征。这些特征随后与变异向量 V 拼接，并作为差分孪生网络（Differential Siamese Networks）的输入。最后，其输出通过两个 Lambda 层进行“差值除以 2”和“取平均”的操作。为了将反对称性质融入网络结构，我们设计了一个特定的损失函数，该函数同时最小化平均输出的绝对值以及差值输出与真实 ∆∆G 值之间的距离。ACDC-NN-Seq 的网络架构如图 1 和图 2 所示。

<div style="float: left; width: 45%; margin-right: 5%;">
  <img src="https://cloudflare.remsait.com/img/ACDC-NN-SEQ202510221422183.png" 
       style="width: 100%; max-width: 500px; min-width: 300px; height: auto;">
  <p style="text-align: center; margin-top: 8px; font-size: 14px;">图1</p>
</div>
<div style="float: left; width: 45%;">
  <img src="https://cloudflare.remsait.com/img/ACDC-NN-SEQ202510221423633.png" 
       style="width: 100%; max-width: 500px; min-width: 300px; height: auto;">
  <p style="text-align: center; margin-top: 8px; font-size: 14px;">图2</p>
</div>
<div style="clear: both;"></div>

  选择7个残基的输入窗口（即在感兴趣位置的每侧各3个残基）是为了学习DDGun3D映射（在预训练阶段），因为我们采用了与DDGun3D相同的序列邻域。虽然我们也试验了其他一些输入窗口大小，但在多达11个残基时，并没有发现太大的差异，只是在超过这个数目时出现了性能下降的情况。
### 预训练阶段
  由于缺乏足够的实验数据从零开始训练网络，我们首先在一个人工数据集上对模型进行预训练，然后在真实数据集上进行迁移学习。预训练阶段使用了无标签的人工数据集IvankovDDGun，该数据集包含了每个序列位置上所有可能的正向和逆向变异。我们选择使用一种基于三维结构的方法对IvankovDDGun数据集进行预测，以便从序列中内部编码三维信息；在多种预测工具中，我们选用了DDGun3D，因为它几乎完美地满足了反对称性。DDGun3D所使用的训练集、验证集和测试集分别包含400,000、100,000和100,000个蛋白质变异体。差分孪生网络由两个隐藏层组成，分别包含128和64个神经元（完整描述见表2）。
| NN Parameters         | Before Transfer-Learning | After Transfer-Learning |
|-----------------------|--------------------------|-------------------------|
| Hidden units          | 12,864                   | 12,864                  |
| Dropout               | 0.05                     | 0.35                    |
| Epochs                | 45                       | 30                      |
| Batch-size            | 500                      | 150                     |
| Optimizer             | Adam                     | Adam                    |
| Loss                  | logcosh + abs            | logcosh + abs           |

### 在实验数据上的迁移学习
  在预训练阶段之后，我们使用实验∆∆G值数据集S2648和Varibench进行迁移学习，并对数据进行划分，同时去除训练集、验证集和测试集之间的序列相似性。具体而言，卷积层的权重保持固定，而差分孪生网络部分则被重新训练以选择最佳参数。为了增加训练集的规模，我们还纳入了带有DDGun3D预测结果的无标签数据集Ivankov2000。最优参数集合的完整描述见表2。
### 性能评估
  采用预测值与观测值之间的皮尔逊相关系数（记为 r）和均方根误差（RMSE）来评估方法的性能。为了评估∆∆G预测工具的反对称性，采用了两个评分指标：rd−i 和 〈δ〉。rd−i 是正向变异与其对应逆向变异预测结果之间的皮尔逊相关系数：
  $$r_{d-i} = \frac{Cov(\Delta\Delta G^{dir},\Delta\Delta G^{inv})}{\sigma _{dir}\sigma _{inv}}$$
  其中，Cov 表示协方差，σ 表示标准差。〈δ〉 是衡量预测偏移的平均偏差：
  $$\langle \delta \rangle = \frac{1}{2N} \sum_{i=1}^{N} \left( \Delta\Delta G_i^{\text{dir}} + \Delta\Delta G_i^{\text{inv}} \right)$$
  一个完全满足反对称性的方法，其 rd−i 应等于 -1，〈δ〉 应等于 0。

## 结果
### 在人工数据上学习三维特性
  神经网络的充分训练需要大量的实验∆∆G值，而目前这类数据尚不充足；为解决这一问题，我们在人工数据集IvankovDDGun上进行了预训练，然后在实验数据集S2648和Varibench上应用迁移学习，具体方法如“材料与方法”部分所述。
  
  表3展示了在IvankovDDGun测试集上的结果。值得注意的是，DDGun3D的值是基于蛋白质结构计算得出的，而ACDC-NN-Seq的预测仅依赖于序列信息。因此，该方法成功获得了一种基于序列的预测工具，能够在内部编码保持反对称性质的三维统计势函数。
| Dataset       | Pearson/RMSE       | Antisymmetry       | Direct  | Reverse | rd−i  | 〈δ〉  |
|---------------|--------------------|--------------------|---------|---------|-------|-------|
| IvankovDDGun (Test) | 0.97/0.06          | 0.97/0.06          | −1.0    | 0.0     |       |       |

### 实验∆∆G值的预测
  在IvankovDDGun数据集上训练ACDC-NN-Seq后，我们通过10折交叉验证，在来自S2648和Varibench的实验测定∆∆G值上对网络的最后几层进行了微调。图3展示了在Varibench和S2648数据集（单独及合并）上，实验∆∆G值与ACDC-NN-Seq预测值之间的对比，涵盖了正向和逆向变异。这些结果是按照Benevenuta等人所述的交叉验证方式获得的。ACDC-NN-Seq不仅在性能上（以r和RMSE衡量）与当前最先进的方法相当，而且实现了完美的反对称性（rd−i = −1 且 〈δ〉 = 0.0）。
  
  我们还将ACDC-NN-Seq和DDGun的预测结果分别与其基于结构的版本（即ACDC-NN和DDGun3D）进行了比较。图4报告了在Ssym数据集上的性能对比（ACDC-NN和ACDC-NN-Seq采用交叉验证），该数据集专门用于评估反对称性，包含了正向和逆向变异的实验∆∆G值。ACDC-NN-Seq的性能均衡，且接近使用蛋白质结构所获得的结果。这使得ACDC-NN-Seq成为基因组变异分析的理想工具。
  
  为了评估神经网络设计的影响，我们将ACDC-NN-Seq与一个在相同条件下训练和优化的前馈神经网络（FFNN）进行了比较。该优化后的FFNN结构包括：一个包含140个输入神经元的输入层（使用20维向量谱编码的7个残基窗口）、一系列隐藏层（分别包含128、64、32、16个神经元），以及一个输出神经元用于预测∆∆G值。因此，主要差异在于ACDC-NN-Seq具有反对称性的网络构造（FFNN结构见图4）。FFNN的表现也相当不错，神经网络从提供的数据（正向和逆向变异）中学习到了大部分反对称性。然而，ACDC-NN-Seq在预测任务和反对称性重建方面均优于FFNN。
  
  关于图3和图4中呈现的结果，值得注意的是，皮尔逊相关系数的最大可达到值并不一定等于通常认为的1，它可能显著更低，具体取决于实验的不确定性以及∆∆G值的分布情况。特别是，当考虑ProTherm数据库或手动清理的数据集中同一变异体的不同实验数据时，皮尔逊相关系数的理论上限通常在0.70–0.85范围内。若得到的相关系数显著高于此范围，可能出现在小数据集上，或可能是过拟合问题的征兆。
### 与其他基于序列的机器学习方法的比较
  如上所述，目前仅有少数可用的方法能够仅从序列出发预测变异对蛋白质稳定性的影响。因此，我们在三个数据集上将ACDC-NN-Seq与以下基于序列的方法进行了比较：DDGun、INPS、I-Mutant2.0、MUpro以及较新的SAAFEC-SEQ。结果如表4所示；ACDC-NN-Seq在预测正向和逆向变异方面表现均佳，且具有近乎完美的反对称性（rd−i = -0.99）。ACDC-NN-Seq的性能优于INPS，而INPS是此前测试中唯一被证实具有反对称性的机器学习方法。
  
  I-Mutant2.0 和 MUpro 不满足反对称性，因为在创建这两个模型时，这一问题尚未得到充分关注或认知。然而需要指出的是，与需要进行多序列比对的ACDC-NN-Seq相比，I-Mutant2.0 和 MUpro 未使用进化信息，因此它们的预测速度极快。另一个重要之处是，观察表4至表6中列出的所有方法可以发现，只有 Inps-NoSeqId 和所有版本的 ACDC-NN 在交叉验证训练过程中去除了序列一致性（即序列相似性 <25%），以避免过拟合。（表格略
### Frataxin CAGI 5 挑战赛
  基因组解读关键评估（Critical Assessment of Genome Interpretation, CAGI）是一项旨在公正评估基因组解读计算方法的社区实验。在CAGI 5中，数据提供方利用远紫外圆二色光谱和内在荧光光谱，测量了一组Frataxin（FXN）蛋白变异体的解折叠自由能。Frataxin是一种高度保守的蛋白质，在原核生物和真核生物的细胞铁稳态中起着至关重要的作用。这些测量结果被用于计算在零变性剂浓度下，突变体与野生型蛋白质之间的解折叠自由能变化（∆∆G）。此外，该实验数据集包含了八个氨基酸替换，被用于评估基于蛋白质结构信息的网络工具在预测相应∆∆G值方面的性能。在此，我们比较了现有基于机器学习的序列预测工具在该数据集上的表现（见表7），展示了ACDC-NN-Seq预测性能的一致性。

## 讨论
  目前可用于预测∆∆G的基于序列的方法较少，其中仅有部分方法满足热力学所要求的反对称性原则。鉴于当前可获得的海量测序数据及其潜在的广泛应用，我们提出了一种可靠的基于序列的预测工具，该工具可广泛应用于各种生物学问题，即使在缺乏蛋白质晶体结构的情况下也能发挥作用。此外，ACDC-NN-Seq通过采用一种专门设计的损失函数，将正向与逆向预测之间的绝对差异最小化，从而满足了反对称性的物理特性。我们证明，ACDC-NN-Seq在性能上与当前最先进的基于序列的机器学习预测工具相当，甚至优于部分基于结构的方法，如表4至表7所示。为避免因序列相似性导致的过拟合问题，评估任何方法性能的正确做法应是在与训练数据中蛋白质序列不相似的蛋白质变体上进行测试。具体而言，这意味着需去除训练集与测试集之间序列同一性超过25%的蛋白质。本研究遵循了这一流程，在交叉验证过程中将所有使用的数据集划分为10个非相似的子集。总之，ACDC-NN-Seq是一种基于序列的工具，其性能与现有最先进方法相比具有可比性甚至更优，同时保持了完美的热力学反对称性。在未来的研究中，该方法可进一步扩展，用于预测多位点变异的∆∆G值。