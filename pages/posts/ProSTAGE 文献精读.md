---
layout: post
title: ProSTAGE 文献精读
date: 2025-09-23 09:42:47
updated: 2025-09-23
time_warning: true 
cover: 
top: 
tags: 
 - ddg
categories: 
 - 生物信息
# author: @Remsait
---
# ProSTAGE：利用蛋白质嵌入和图卷积网络预测突变对蛋白质稳定性的影响
[ProSTAGE: Predicting Effects of Mutations on Protein Stability by Using Protein Embeddings and Graph Convolutional Networks](https://doi.org/10.1021/acs.jcim.3c01697)
## 摘要
  蛋白质热力学稳定性对于阐明结构、功能和相互作用之间的关系至关重要。因此，开发一种更快、更准确的预测突变对蛋白质稳定性影响的方法，有助于蛋白质设计和理解表型变异。最近的研究表明，蛋白质嵌入在建模具有上下文依赖性的序列信息方面（如亚细胞定位、变异效应和二级结构预测）具有强大的能力。
  
  在此，我们提出了一种新方法ProSTAGE，这是一种深度学习方法，通过融合结构信息和序列嵌入来预测单点突变引起的蛋白质稳定性变化。
  
  我们的模型结合了基于图的技术和语言模型来预测稳定性变化。此外，ProSTAGE在一个更大的数据集上进行训练，该数据集的规模几乎是目前最常用的S2648数据集的两倍。在多个独立数据集上的基准测试中，ProSTAGE在突变影响问题上始终优于所有现有的最先进方法。使用蛋白质嵌入作为预测输入取得了优于以往结果的表现，这展示了蛋白质语言模型在预测突变对蛋白质影响方面的潜力。ProSTAGE已实现为一个用户友好的网络服务器。
## 引言
  热力学稳定性是蛋白质最基本的性质之一，对蛋白质的结构、功能、表达和溶解度具有显著影响。众所周知，在临床医学中，突变可能会降低蛋白质的热力学稳定性。这类突变可能导致基因产物错误折叠，进而引发多种遗传性疾病、癌症和神经退行性疾病。因此，在开发各类生物技术产品（包括基于蛋白质的治疗药物、生物催化剂及其他应用）的过程中，评估突变对蛋白质热力学稳定性（ΔΔG）的影响至关重要。尽管实验测量方法更为理想，但对蛋白质进行全面的实验研究往往不切实际。因此，开发一种计算方法对于蛋白质工程、个性化医疗和精准诊断中的定制化蛋白质设计而言，是至关重要的一步。
  
  在过去的30年中，蛋白质稳定性预测的发展已成为一个高度活跃的研究领域，并已开发出数十种预测方法。这些方法大多基于人工智能，通常利用序列信息、结构信息、物理力场以及进化信息作为特征，来预测突变的影响。发布的AlphaFold突破了基于结构的方法因缺乏三维结构而无法使用的局限。另一方面，AlphaFold展示了深度学习，特别是自然语言处理（NLP）在建模具有上下文依赖性的序列信息方面的强大能力。
  
  近年来，自然语言处理（NLP）的革命性发展深刻影响了蛋白质研究，多项研究已将语言模型的概念应用于蛋白质序列，例如 UniRep、EMS-1b、TAPE 和 ProtTrans。这些研究表明，蛋白质序列嵌入（即预训练模型输出的向量表示）能够准确预测亚细胞定位和 SCOP（蛋白质结构分类）。这些预训练模型通过嵌入形式为我们提供了对“蛋白质语言”的独特洞察。研究发现，这些嵌入在解决各种下游任务方面非常有效，并显著优于早期基于任务特定小数据集训练的有监督机器学习方法。
  
  然而，大多数现有方法仍然依赖于传统的浅层机器学习技术。其原因是深度学习方法需要大量的输入数据才能进行有效训练。由于标准的训练数据集（如S2648或Q3421）通常仅包含几千个数据条目，因此被认为规模不足，难以支持这些先进深度学习技术的应用。
  
  在这方面，我们开发了一种新方法：ProSTAGE，这是一种深度学习方法，通过融合结构信息和序列嵌入来预测单点突变引起的蛋白质稳定性变化。我们的模型结合了基于图的技术和语言模型来预测稳定性变化。使用基于语言模型的特征向量的优势在于，它无需依赖领域知识即可对序列进行编码。在图模型方面，我们提出了一种空间节点特征，用于捕捉突变位点附近残基相互作用的特性，并将蛋白质语言预训练模型的序列嵌入层输出作为空间节点特征输入到图卷积网络（GCN）中。此外，为了缓解因“数据不足”而导致的模型性能瓶颈问题，ProSTAGE在一个从多个来源收集的训练集上进行训练，该数据集的规模是目前最常用的S2648数据集的两倍。在多个独立数据集上的基准测试表明，ProSTAGE在突变影响的回归问题上始终优于所有现有的最先进方法。ProSTAGE已实现为一个用户友好的网络服务器。
## 材料与方法
### 数据集收集
  我们整合了一个新的、经过筛选的训练数据集，该数据集来源于四个最新发布的数据库：MPTherm、ProthermDB、ThermoMutDB 和 FireProtDB。这些突变均具有已知的ΔΔG值，并满足以下筛选条件：（1）单点突变且具有ΔΔG值；（2）非冗余数据。其中，4335个突变为稳定性降低突变（ΔΔG ≤ 0），1317个突变为稳定性增强突变（ΔΔG > 0）。为了平衡稳定性增强和稳定性降低的突变数据，我们采用了与其他方法相同的方式，以满足反称性原则。具体而言，如果蛋白质B是蛋白质A的突变体，则有ΔΔG(A→B) = −ΔΔG(B→A)。这一处理最终生成了我们的训练集S11304，共包含11,304个突变，涉及318种蛋白质，是迄今为止用于蛋白质稳定性预测任务中规模最大的训练数据集。
  
  S669：一个严格且被广泛使用的盲测数据集。该数据集由Pancotti等人整理，包含669个单点突变，每个突变均提供了实验测定的热力学数据（ΔΔG）。
  
  Tm262：一个仅包含Tm实验值的盲测数据集。由于我们的训练数据集几乎涵盖了当前所有可用的实验ΔΔG数据，为了更公平地评估现有先进方法之间的性能差异，我们额外设计了该盲测数据集。该数据集由262个单点突变组成，其实验ΔTm值来源于与训练数据集相同的数据库。在采用与训练集类似的筛选标准之外，还应用了以下规则：（1）实验数据仅提供ΔTm值；（2）|ΔTm| ≥ 10 °C。
  
  PTEN 和 TPMT：第三个盲测数据集来自 CAGI5 挑战赛的深度突变扫描（DMS）数据集，包含磷酸酶及张力蛋白同源物（PTEN）和硫嘌呤 S-甲基转移酶（TPMT）蛋白，其中 PTEN 蛋白有 3736 个突变，TPMT 蛋白有 3627 个突变，总计 7363 个突变。该数据集下载自`https:// genomeinterpretation.org/content/predict-effect-missensemutations-pten-and-tpmt-protein-stability`。所有数据集的详细信息见表[S1-S4](https://pubs.acs.org/doi/suppl/10.1021/acs.jcim.3c01697/suppl_file/ci3c01697_si_001.pdf)  
### 图卷积网络架构
  给定一个图 G = (V, E) ，其中 V 是包含 K 个结点的集合，E 是边的集合，图卷积网络（GCN）的输入包括：
  * 节点特征 X，X 的维度为 N × F₀，其中 N 是节点数量，F₀ 是每个节点的特征数量。
  * 图的邻接矩阵 A，A 的维度为 N × N。

  （ProSTAGE的GCN输入 = 整个蛋白质的三维结构（PDB文件） + 野生型/突变体序列，但模型仅使用突变位点10Å范围内的局部结构）

  在蛋白质中，节点代表构成蛋白质的氨基酸，而残基之间的相互作用构成了邻接矩阵。模型的输入是通过其邻接矩阵和节点特征矩阵表示的图。该模型包含三个图卷积层（GCN），这些层同时接收空间邻接矩阵和前一层的嵌入作为输入，并输出下一层的嵌入。每个图卷积层有64个单元。三层图卷积层的嵌入被拼接成一个矩阵。然后，这个矩阵会经过一个池化层，同时在此层加入基于知识的额外特征。之后，使用三个全连接层来映射前一层的嵌入并输出下一层的嵌入，最终层输出一个用于预测ΔΔG的值。
  
  在这个工作中，我们使用DGL库（版本1.1.0）中的`dgl.nn.pytorch.conv.GraphConv`类构建了GCN模型。此外，我们还使用伪代码描述了模型开发的工作流程，详细信息可以在支持信息中找到。这整个过程使得ProSTAGE能够有效利用蛋白质序列和结构信息进行突变对蛋白质稳定性影响的预测。
### 结点特征
  基于图的蛋白质节点特征通常采用独热编码（one-hot）或物理化学性质、进化信息等来编码每个节点的特征。在本研究中，我们采用由 ProtT5-XL-Uniref50 预训练模型生成的蛋白质序列嵌入作为节点特征。
  
  ProtT5-XL-Uniref50 预训练模型由 Elnaggar 等人开发，该模型基于 T5 架构，包含 30 亿（3B）参数，并在 4.5 亿（450M）条蛋白质序列上进行训练。它是一种基于 Transformer 的编码器-解码器架构，通过随机遮蔽蛋白质序列语料库中 15% 的氨基酸进行自监督学习。模型训练使用的学习率为 0.01，本地批量大小为 8，全局批量大小为 2048，dropout 率为 0.1，并采用 AdaFactor 优化器进行优化。该模型包含 24 层网络，每层有 32 个注意力头，隐藏层维度为 1024。与其他流行的蛋白质语言模型相比，它在多个下游任务中均取得了最先进的性能。
  
  传统方法通常基于序列信息，选取突变位点左右两侧若干氨基酸作为节点。然而，通过空间距离构建节点更为合理，因为突变会改变其周围的空间相互作用。在本方法中，一个突变通过野生型序列嵌入和突变体序列嵌入的拼接来表示。这意味着，每个节点的特征是一个维度为 N × 2048 的矩阵，其中 N 是距离突变位点 10 Å 以内的残基集合，$F^0$ = 2048（为隐藏层维度1024的两倍）是拼接后嵌入向量的长度。我们将该矩阵称为突变嵌入（mutational embedding），它能够反映突变对整个序列的影响。（残基级图
### 空间邻接矩阵（SAM）
  邻接矩阵用于指示图中各节点对是否彼此相邻。该理论基于将蛋白质结构视为一个网络，其中每个氨基酸根据某种关系直接相互连接；每个节点与其他节点的连接关系，对应于一个氨基酸与周围其他氨基酸之间的相互作用。对于几何模型，我们将每个残基的Cα原子定义为一个节点，若两个节点之间的距离在10 Å以内，则在这两个节点之间建立边。随后，将每个残基对应的突变嵌入（mutational embedding）分配给蛋白质图中相应的节点。
### 额外的基于知识的特征（AKB）
  此外，还引入了一组关于野生型残基环境特征的额外知识（例如，相对溶剂可及性、保守性得分和二级结构），并将这些特征添加到全连接层中。详细信息见支持信息部分。
## 结果
### 设计一种新颖的图卷积网络框架
  我们开发了深度学习方法ProSTAGE，该方法结合了用于结构信息的图卷积网络（GCN）和用于序列信息的蛋白质嵌入（protein embedding）。ProSTAGE的GCN架构将蛋白质嵌入、空间邻接矩阵以及额外的基于知识的特征作为输入来训练模型。GCN用于捕获突变位点的短程残基相互作用，而语言模型则用于表征蛋白质序列的长程信息。我们使用S11304数据集作为训练集，其余数据集作为测试集以评估模型性能。ProSTAGE在此采用了损失函数，该函数包含预测值与实验值之间的均方误差（MSE）。为避免过拟合，我们使用早停准则（early stopping），设定耐心值（patience）为5。模型架构如图1所示。
<img src="https://cloudflare.remsait.com/img/prostage202509231144542.png"  alt="404" title=""  />
<center><div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
      模型架构
  	</div>
</center>
  模型架构概述：ProSTAGE从蛋白质3D结构中提取两部分信息：相互作用网络和序列嵌入。序列嵌入来源于ProtT5-XL-Uniref50模型，每个方块代表一个1024维的特征，将野生型和突变体的嵌入拼接后得到2048维的特征。相互作用网络由距离突变位点10 Å以内的残基构成。模型包含三个图卷积层，每一层接收空间邻接矩阵和前一层输出的嵌入作为输入，并生成下一层的嵌入。三个图卷积层的嵌入被拼接成一个矩阵，随后进入池化层，并在此层加入额外的基于知识的特征。接着，通过三个全连接层，由池化后的表示计算出最终的嵌入。最后，由该GCN模型预测ΔΔG值。  
  
  我们在S11304数据集上训练了ProSTAGE，训练方法如“方法”部分所述。模型在20%训练集上的5折交叉验证性能如图2所示，皮尔逊相关系数（PCC）为0.84，均方根误差（RMSE）为1.09 kcal/mol。模型完美满足反称性（antisymmetry）性质，正向突变与逆向突变之间的PCC为−0.93，偏差（δ）仅为−0.003 kcal/mol。此外，我们还进行了留一蛋白质交叉验证（LOPOCV），以进一步评估模型性能，其PCC和RMSE值分别为0.75和1.34 kcal/mol（图S1）。 
  
  后略（性能对比图去文献看，S2648 版比 ddgemb 低 0.1
## 讨论
  蛋白质稳定性预测仍然是一个复杂且具有挑战性的问题。得益于深度学习算法的发展，蛋白质稳定性预测的研究重点已从传统的浅层机器学习方法转向复杂的深度学习方法。然而，传统训练数据集（如S2648或Q3421）已无法满足深度学习日益增长的训练数据需求。另一方面，基于人工智能的结构预测方法的出现，消除了基于结构和基于序列的蛋白质稳定性预测方法之间的输入限制，使人们能够根据需求选择基于结构或基于序列的方法。
  
  在这一背景下，我们提出了一种新的预测工具及网络服务器——ProSTAGE。该工具是一种图卷积网络，通过利用正向与逆向突变来保证模型的反称性（antisymmetry），并融合蛋白质嵌入（protein embedding）和空间邻接矩阵，以更好地捕捉残基间的短程相互作用以及蛋白质序列的长程语言学信息。使用基于语言模型的特征向量的一个主要优势在于，它消除了以往蛋白质稳定性预测中编码序列所需的领域知识，这在该领域中是一条此前未被探索的路径。实验结果表明，该方法在预测突变引起的蛋白质稳定性变化方面具有显著有效性。
  
  消融研究（Ablation study）表明，蛋白质嵌入能够揭示蛋白质序列的语言学上下文信息，从而进一步提升模型的预测准确性。ProSTAGE使用的训练集远大于以往报道的方法（规模是S2648的两倍），有效降低了过拟合风险，并在多个盲测数据集上优于其他预测工具，尤其在准确率和AUC指标上表现突出。此外，我们的方法展现出显著的鲁棒性和性能稳定性：即使使用AlphaFold2预测的结构作为输入，仍能保持较高的预测准确性，从而在不牺牲精度的前提下极大地提升了蛋白质稳定性预测的可扩展性。
  
  我们相信，ProSTAGE将成为多种应用中的有用工具，例如关键残基的识别、致病相关突变的推断以及蛋白质工程等。
