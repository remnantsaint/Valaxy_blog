---
layout: post
title: DVE-stability 文献精读
date: 2025-12-23 10:31:54
updated: 2025-12-23
time_warning: true 
cover: 
top: 
tags: 
 - ddg
categories: 
 - 生物信息
draft: 
# author: @Remsait
---
# 基于单序列的双视角集成学习预测突变对蛋白质稳定性的影响
  [Predicting protein stability changes upon mutations  with dual-view ensemble learning from single sequence](https://doi.org/10.1093/bib/bbaf319)

  https://github.com/ZhiweiNiepku/DVE-stability

## 摘要
  预测突变对蛋白质稳定性的影响是提升蛋白质工程效率的有效途径之一。本文提出了一种基于双视角集成学习的框架——DVE-stability，用于仅从蛋白质单序列出发预测突变所引起的稳定性变化。DVE-stability 通过集成学习整合突变的全局与局部依赖关系，从两个视角捕捉分子内相互作用，并设计了一个结构微环境模拟模块，在序列层面间接引入结构微环境信息。DVE-stability 在七个单点突变基准数据集上取得了当前最优的预测性能，并在其中五个数据集上全面超越了现有方法。此外，在多点突变预测任务中，DVE-stability 通过零样本推理（zero-shot inference）全面优于其他方法，展现出卓越的模型泛化能力，能够有效捕捉多点突变间的上位效应（epistasis）。更重要的是，DVE-stability 在预测对实际蛋白质定向进化至关重要的稀有有益突变方面表现出优异的泛化性能。此外，DVE-stability 还可通过注意力评分识别关键的分子内相互作用，具备良好的可解释性。总体而言，DVE-stability 以一种可解释的集成学习方式，为突变诱导的蛋白质稳定性变化预测提供了一种灵活高效的工具。

## 引言
  量化突变所引起的影响对于探索蛋白质的进化适应性景观至关重要。蛋白质热力学稳定性尤其受到关注，因为它为理解蛋白质折叠机制与功能提供了重要线索，从而推动了在药物生物制剂和工业生物催化剂领域的蛋白质工程研究。鉴于传统的实验方法测定突变引起的蛋白质稳定性变化在时间和成本上代价高昂，大量计算方法应运而生，用于预测突变对蛋白质稳定性的影响。

  现有的用于预测突变诱导蛋白质稳定性变化的计算方法，尤其是深度学习方法，可分为两大类：基于结构的方法和基于序列的方法。基于结构的方法通过输入蛋白质三维结构来预测单点突变引起的稳定性变化。例如，ThermoMPNN 采用预训练的ProteinMPNN模型对蛋白质结构进行编码，并将该编码用于后续的稳定性变化预测模块；Stability Oracle 则预训练了一个图Transformer主干网络，用于稳定性变化的回归预测；GeoDDG-3D 利用了预训练的图注意力神经网络架构的几何编码器。

  相比之下，基于序列的方法仅需蛋白质序列即可预测突变引起的稳定性变化。例如，Mutate Everything 利用预训练的特征提取器（如进化尺度建模ESM 或AlphaFold ）来计算输入序列中每个氨基酸级别的特征；PROSTATA 则采用预训练的ESM模型作为蛋白质序列的嵌入主干；SPIRED-Stab 开发了一种基于单序列的预训练结构预测模型，用于蛋白质稳定性变化预测。
  
  对于基于结构的方法而言，少量突变通常不会引起三维结构的显著改变，因此其性能受限于高度相似的结构特征。而基于序列的方法虽能获取更具判别性的序列特征，却无法编码突变所处的结构微环境信息，导致其泛化能力面临瓶颈。
  
  在真实实验室的蛋白质工程情景中，预测方法的性能决定了工程的速度，而预测方法的泛化能力则决定了其应用范围。因此，为了兼顾预测性能和泛化能力，我们提出了一种基于双视角集成学习的框架——DVE-stability，用于基于蛋白质序列的稳定性变化预测。DVE-stability整合了由长程相互作用主导的突变全局依赖性以及由结构微环境决定的局部依赖性，使神经网络能够通过集成学习从两个视角捕捉突变所处位置的分子内相互作用网络。鉴于结构微环境对突变引起稳定性的变化至关重要，我们认为以间接方式将结构微环境的信息引入基于序列的方法是有益的。为此，我们提出了一个结构微环境模拟（SMS）模块嵌入到DVE-stability框架中，以便在序列水平间接引入结构微环境信息。
  
  DVE-stability在七个单点突变基准数据集上实现了最先进的预测性能，并在其中五个数据集上全面超越了其他方法。更重要的是，DVE-stability通过零样本推理在多点突变预测任务和稀有有益突变挖掘任务中展现了卓越的泛化性能。总体而言，DVE-stability代表了一种可解释的集成学习方法，用于从单序列预测突变引起的蛋白质稳定性变化，有望为蛋白质工程提供一种高效且具广泛适用性的工具。
  
## 结果
### DVE-stability 的双视角集成学习架构
  DVE-stability 的双视角集成学习架构（图1a）旨在同时内化由长程相互作用主导的突变全局依赖性，以及由结构微环境决定的突变局部依赖性。首先，突变型蛋白质序列及其野生型序列被并行输入到预训练的蛋白质语言模型（PLM）ESM-2-650M 中，以提取对应的氨基酸级别嵌入表示。其次，在突变型和野生型蛋白质中分别提取突变的双视角相互作用依赖关系。值得注意的是，在训练过程中，所采用的 ESM-2-650M 模型的所有参数均被直接微调。
  
  CLS token 是 Transformer 架构中在输入序列起始位置添加的一个特殊标记，其输出向量被设计为整个输入序列的全局语义表示。在文本分类、语义匹配和对比学习等任务中，该标记承载了整句话语义的抽象信息，便于直接用于下游任务。在本研究中，我们利用 CLS token 表征突变在整个蛋白质序列上的全局依赖性；而突变对其结构邻近残基的局部依赖性则通过结构微环境模拟（SMS）模块构建。
  
  如图1b所示，考虑到突变对适应性的影响在很大程度上由其结构微环境决定，我们在序列层面模拟结构微环境，从而间接构建并编码突变在三维结构中的局部依赖关系。为此，SMS 模块被设计用于识别可能构成突变结构微环境的相关残基，并进行特征融合。具体而言，鉴于已有研究表明蛋白质语言模型（PLM）的注意力图在一定程度上能够捕捉残基间的接触关系，我们采用参数冻结的 ESM-2-650M 模型，依据分配的注意力得分来识别结构邻近残基。选取注意力得分最高的前3个残基，其余残基则被过滤掉。随后，这些被选中残基的嵌入通过一个 Transformer 块融合为一个代表突变局部依赖性的“ENV”嵌入（图1c）。
  
  第三，将突变蛋白序列中突变所引起的全局依赖性与其野生型序列中的全局依赖性相减，以凸显突变对蛋白质分子内相互作用网络的影响；局部依赖性也以相同方式进行处理。
  
  第四，分别利用全局依赖性差异和局部依赖性差异来预测突变引起的蛋白质稳定性变化（即 ΔΔG），最终的预测结果为两个分支预测值的平均值。
### 单点突变的预测性能
  为评估 DVE-stability 在单点突变引起的蛋白质稳定性变化预测方面的性能，我们采用广受认可的基准数据集 S669 作为测试集。参照先前研究 Mutate Everything 的评估设置（使用高通量数据集进行训练），我们在表1中对比了不同方法在单点突变预测任务中的表现。值得注意的是，为确保评估的稳健性，我们构建了 S669 的反向数据集（见方法 4.1.1）。通过对分类任务（判断突变是否稳定）和回归任务（ΔΔG 回归）的全面比较，我们发现 DVE-stability 在所有评估指标上均达到最优或次优水平，实现了当前最先进的预测性能。
  
  此外，为进一步验证评估的稳健性，我们在另外六个单点突变数据集上评估了不同方法的预测性能，包括 S461、S783、肌红蛋白（Myoglobin）、磷酸酶与张力同源物及硫嘌呤 S-甲基转移酶（PTEN&TPMT）、S349 和 T2837。相关预测结果见补充材料表 S1–S4，其中我们的 DVE-stability 模型在所有这些额外数据集上均取得了最先进的预测性能。
  
  在传统的评估协议中，评估指标通常采用跨蛋白质的评估方法（即对测试集中所有蛋白质突变体统一计算）。然而，这种评估策略不足以反映预测模型对单个蛋白质的多个单点突变进行排序的真实能力——而这种能力在实际的蛋白质工程场景中更具相关性。因此，我们遵循了先前研究 SPIRED-Stab 所采用的评估协议：首先计算每个蛋白质内部的评估指标，然后报告所有测试蛋白质中各项指标的平均值和标准差。
  
  如表2所示，在使用 S2648 数据集训练的情况下，DVE-stability 在所有评估指标（即 Spearman、Kendall 和 Pearson 相关系数，以及 Top-K 精确率）上均达到最优或次优水平，优于其他预测方法，充分证明了其在实际蛋白质工程应用中的适用性。
### 多点突变的泛化性能
  DVE-stability 能够通过零样本推理（zero-shot inference）推广至多点突变引起的稳定性变化预测。在输入含多个突变的蛋白质序列时，只需对多个突变位点的 ENV 特征取平均值，再与 CLS 特征进行集成学习即可。
  
  参照先前研究 GeoDDG 的评估设置，我们仅使用单点突变数据（S8754 数据集）训练 DVE-stability，随后在 M1261 数据集上进行测试（包含 792 个双点突变样本和 469 个三点及以上高阶突变样本）。如表3所示，无论是在双点突变数据还是在三点及更高阶突变数据上，DVE-stability 均通过零样本推理全面超越了其他方法。
  
  值得注意的是，尽管 DynaMut2 和 DDMut 均使用了多点突变数据进行训练，且 GeoDDG-3D 还复用了在大量深度突变扫描（deep mutational scanning）适应性数据上预训练的模型，DVE-stability 依然在各项指标上全面优于这些方法，展现出卓越的模型泛化能力，能够有效捕捉多点突变之间的上位效应（epistasis）。
### 稀有有益突变的泛化性能
  在广阔的蛋白质进化空间中，实验室中的定向进化需要寻找能够提升蛋白质适应性的稀有有益突变。鉴于对适应性提升有益的突变仅占蛋白质进化适应性景观中的极小一部分，准确挖掘这些稀有有益突变是提高蛋白质定向进化效率的潜在手段之一。该零样本预测任务的核心目标是避免遗漏稀有有益突变，即尽可能获得更高的“召回率”（recall）指标。
  
  为比较不同预测方法在真实湿实验（wet-lab）定向进化场景中的泛化性能，我们选取了一个具有代表性的酶工程案例——热稳定性提升的 IsPETase 工程改造，并据此设计了验证实验。在该验证实验中，共包含 85 个单点突变，其中 21 个为有益突变，64 个为有害突变（见补充表 S5 和 S6）。
  
  我们选取了三类近期高性能的方法进行预测性能对比：无监督的蛋白质进化方法（采用蛋白质语言模型集成投票策略，简称 PLMVoting）；基于结构的有监督 ΔΔG 预测方法（包括 ThermoMPNN 和 GeoDDG-3D ）；基于序列的有监督 ΔΔG 预测方法（包括 PROSTATA 、Mutate Everything 和 SPIRED-Stab ）。
  
  为确保统计稳健性，我们采用了自助法（bootstrapping）构建了 5000 个伪数据集，并报告了这 5000 次实验中召回率（recall）指标的均值、标准差和置信区间。不同方法的预测结果如表 4 所示，从中可见 DVE-stability 显著优于其他预测方法。总体而言，DVE-stability 在挖掘对实际蛋白质工程至关重要的稀有有益突变方面展现出卓越的泛化性能。
### 消融实验
  为评估关键组件对 DVE-stability 预测性能的影响，我们开展了多项消融实验，结果如表5所示。为量化三个关键组件（集成学习、CLS 嵌入、ENV 嵌入）的作用，我们构建了四种 DVE-stability 的变体模型：不使用集成学习的 DVE-stability（w/o ensemble）；不使用 CLS 嵌入的 DVE-stability（w/o CLS）；不使用 ENV 嵌入的 DVE-stability（w/o ENV）；同时移除所有关键组件的 DVE-stability（w/o all）。
  
  无论是在 S669 数据集的正向版本还是反向版本上，移除任一组件均导致预测性能下降，其中移除 ENV 嵌入造成的性能退化最为显著。当所有关键组件均被移除时，DVE-stability 的预测性能进一步严重恶化。综上所述，这三个关键组件均对 DVE-stability 的预测能力具有积极贡献。
  
  此外，我们还探究了不同类型训练数据对 DVE-stability 的影响。具体而言，我们分别使用高通量适应性（fitness）数据集和稳定性数据集 S2648（方法 4.1）训练了两个不同版本的 DVE-stability。如图 2 所示，以稳定性变化作为划分有益突变（稳定性增强）和有害突变（稳定性降低）的标准，我们比较了这两个 DVE-stability 版本所提取的 CLS 和 ENV 特征的降维结果，并与原始 ESM-2-650M 模型进行了对比。
  
  在 S669 和肌红蛋白（Myoglobin）测试集上，正如预期，原始 ESM-2-650M 模型几乎无法区分有益突变与有害突变。仅使用适应性数据（高通量数据集）训练的 DVE-stability 对以蛋白质稳定性变化标注的 CLS 和 ENV 特征已展现出一定程度的判别能力，这为蛋白质“适应性”与“稳定性”之间的相关性提供了证据。也就是说，蛋白质的“稳定性”指其维持自身结构的能力，而“适应性”则反映其执行生物学功能的效果；稳定性通常是高适应性的必要条件，但并非充分条件。此外，使用稳定性变化数据（S2648 数据集）训练的 DVE-stability 在区分这两类突变方面表现出了更强的判别能力。
  
### DVE-stability 的可解释性
  为展示 DVE-stability 在分子内相互作用方面的可解释性，我们选取了具有代表性的蛋白质 G-B1 结构域进行案例分析。如图 3a 所示，以 F52 为中心残基，标出了 DVE-stability 模型分配注意力得分最高的前 10 个残基。可以发现，DVE-stability 对与 F52 形成 π–π 相互作用的若干残基（Y3、L5、F30、W43 和 Y45）赋予了更高的注意力得分，这与 F52 及这些残基参与疏水核心成核事件的研究结果一致。
  
  此外，我们还采用了多个热稳定性提升的酶工程案例，以验证 DVE-stability 对成对突变所引起适应性效应的敏感性。具体而言，我们计算并可视化了四个代表性案例中成对突变之间的注意力得分，包括 IsPETase 上的 S238F/W159H ，以及 ThermoPETase 、FAST-PETase 和 TS-PETase 中的相应突变组合。若计算得到的注意力得分相较于野生型残基对有所增加，则标记为“正向”，并标注相应的提升比例；否则标记为“负向”，并标注相应的衰减比例。如图 3b 所示，在所有分析的成对突变中，超过 83% 表现出注意力得分的上升，仅有 2 对突变的注意力得分下降，表明 DVE-stability 能够有效感知酶热稳定性提升背后由突变引起的适应性效应变化，具有良好的敏感性和可解释性。
## 讨论
  通过双视角集成学习，DVE-stability 融合了突变的全局相互作用依赖性和局部相互作用依赖性，仅基于单一序列即可预测突变引起的蛋白质稳定性变化。在单点突变任务场景中，DVE-stability 在全部七个基准数据集上均达到了当前最先进的预测性能，并在其中五个数据集上全面超越其他预测方法。在多点突变任务场景中，DVE-stability 通过零样本推理（zero-shot inference）全面优于现有方法。在稀有有益突变任务场景中，DVE-stability 同样展现出卓越的泛化能力。
  
  此外，DVE-stability 还具备良好的可解释性，能够通过注意力得分识别关键的分子内相互作用。然而，DVE-stability 目前在预测非等长突变（即氨基酸的插入或缺失）任务方面仍存在局限。下一步，我们计划在 DVE-stability 框架中引入特殊标记（special tokens）来表示插入或删除的残基，从而支持对非等长突变所引起稳定性变化的预测。
  
  展望未来，随着社区可用数据的不断积累，DVE-stability 有望通过在更大规模数据集上的训练进一步提升其预测性能。
## 方法
### 数据集
### 假设的反向突变
  蛋白质稳定性变化可通过野生型蛋白与其突变体之间折叠自由能（ΔΔG）的差异来衡量。考虑到自由能是一个热力学状态函数，ΔΔG 仅由野生型和突变体这两个端点决定，与路径无关。因此，从突变体回到野生型（M → W）的折叠自由能变化 ΔΔGM→W 与从野生型变为突变体（W → M）的自由能变化 ΔΔGW→M 互为相反数。
  
  在本研究中，我们为基准数据集 S669 构建了一个由假设反向突变组成的反向数据集（命名为 S669 reverse）。该反向数据集用于评估不同方法的预测对称性（即正向突变与反向突变的预测结果符号相反），这是衡量模型鲁棒性的一个重要方面。
### 训练数据集
#### 高通量数据集
  高通量数据集来源于大规模折叠稳定性估计的 cDNA 蛋白酶解数据集，该数据集基于深度突变扫描（deep mutational scanning），反映了蛋白质突变所引起的适应性（fitness）变化。我们使用 mmseqs2 工具库对蛋白序列进行过滤，设定与测试集之间的序列同一性阈值为 30%（即训练集中的蛋白质与测试集中的蛋白质序列相似度不超过 30%）。经过此过滤后，我们共采用了来自 116 种蛋白质的 213,000 个突变数据，其中包括 97,000 个双点突变和 117,000 个单点突变。
#### S2648数据集
  S2648 数据集包含来自 131 种蛋白质的 2648 个非冗余单点突变体，每个突变体均附有对应的 ΔΔG 值。该数据集已被广泛用作先前蛋白质稳定性变化预测方法的训练集。S2648 中的序列与其测试集 S669 中的序列最多仅有 25% 的序列相似性。
#### S8754数据集
  S8754 数据集包含来自 301 种蛋白质的 8754 个单点突变，这些数据收集自两个 ΔΔG 数据资源：ProThermDB 和 ThermoMutDB 。在整合过程中，非重叠的数据被合并，而重复部分则进行了去重处理，以确保每条数据的唯一性和高可信度。此外，与测试集（S669 数据集）序列同一性超过 25% 的序列均被剔除。
#### C2878 数据集
  C2878 数据集整合自 Q1744、O2567、S2648 和 FireProtDB。对于重复数据，保留绝对值最大的 ΔΔG 测量值；同时，通过设定与对应测试集（T2837 数据集）之间 30% 的序列同一性阈值，对序列进行了过滤。
### 测试数据集
#### S669 数据集
  S669 数据集是一个人工整理的数据集，包含 669 个单点突变及其对应的 ΔΔG 测量值（源自 ThermoMutDB中精选的 94 种蛋白质），其序列与最常用的训练集 S2648 的序列同一性低于 25%。该数据集已被大量先前研究采用，是广泛认可的基准测试集。
#### S461 数据集
  S461 数据集是 S669 的一个更高质量子集（包含 461 个单点突变），通过剔除原始 S669 数据集中存在错误的条目获得。
#### S783 数据集
  S783 数据集源自 S921 数据集——后者是用于评估在 S2648 上训练的预测模型的一个公认测试集。S783 通过去除冗余条目构建而成：包括 S921 与 S2648 中完全相同的突变，以及 S921 中仅为 S2648 中突变反向形式的条目。
#### S349 数据集
  S349 数据集是从 S2648 中选取的一个常用盲测集，包含 349 个单点突变。
#### 肌红蛋白（Myoglobin）数据集
  肌红蛋白数据集包含 134 个单点突变，来源于调控细胞内氧浓度的胞质球状蛋白——肌红蛋白。
#### PTEN&TPMT 数据集
  PTEN&TPMT 数据集是一个基于深度突变扫描的 PTEN 和 TPMT 蛋白数据集，共包含 7363 个单点突变。
#### T2837 数据集
  T2837 数据集整合自 P53、肌红蛋白、SSym、S669 和 C5266。对于重复条目，保留绝对值最大的 ΔΔG 测量值。
#### M1261 数据集
  M1261 数据集是一个多点突变的基准测试集，包含来自 133 种蛋白质的 792 个双点突变数据和 469 个三点及以上高阶突变数据。
## 方法
  略