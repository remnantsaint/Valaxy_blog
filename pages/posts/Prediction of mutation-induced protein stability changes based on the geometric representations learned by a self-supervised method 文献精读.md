---
layout: post
title: Prediction of mutation-induced protein stability changes based on the geometric representations learned by a self-supervised method 文献精读
date: 2025-09-20 12:17:56
updated: 2025-09-20
time_warning: true 
cover: 
top: 
tags: 
 - ddG
categories: 
 - 深度学习
# author: @Remsait
---
# 基于自监督方法学习到的几何表征预测突变诱导的蛋白质稳定性变化
  [Prediction of mutation-induced protein stability changes based on the geometric representations learned by a self-supervised method ](https://doi.org/10.1186/s12859-024-05876-6)  
## 摘要
### 背景
  热稳定性是蛋白质维持其生物学功能的基本特性，预测突变时蛋白质稳定性的变化对于我们理解蛋白质结构-功能关系非常重要，并且在蛋白质工程和药物设计中也具有重要意义。
### 结果
  本文提出了 mutDDG-SSM，一种基于深度学习的框架，利用蛋白质结构中编码的几何表征来预测突变诱导的蛋白质稳定性变化。
  mutDDG-SSM 包含两个部分：一个基于图注意力网络的蛋白质结构特征提取器，该提取器通过自监督学习方法，利用大规模高分辨率蛋白质结构进行训练；一个基于极端梯度提升（XGBoost）模型的稳定性变化预测器，该预测器具有缓解过拟合问题的优势。
  mutDDG-SSM 在多个广泛使用的独立数据集上进行了性能测试，随后以肌红蛋白（myoglobin）和 p53 蛋白作为案例研究，展示了该模型在预测突变引起蛋白质稳定性变化方面的有效性。
  mutDDG-SSM 在评估突变对蛋白质稳定性影响方面表现出高性能，此外具有良好的无偏性，即对逆向突变的预测准确率与正向突变的预测准确率相当。
### 结论
  可以从预训练的模型中提取出有意义的特征，用于构建下游任务，且我们的模型有望成为蛋白质工程和药物设计中的有力工具
### 关键词
  蛋白质稳定性变化、突变、图注意力网络、自监督学习
## 背景
  蛋白质的生物学功能在很大程度上由其三级结构及其相关的热力学稳定性决定，因此氨基酸残基的突变可能通过改变蛋白质的结构稳定性来影响其功能。
  
  先前的研究表明，许多人类疾病至少在部分程度上归因于错义突变所引起的蛋白质稳定化或去稳定化。因此，准确预测氨基酸替换所导致的蛋白质热稳定性变化，对于深入理解蛋白质功能、以及识别导致人类疾病的有害突变具有重要意义。
  
  此外，在生物制药领域的蛋白质工程中，提高蛋白质的热力学稳定性是一个常见的需求。蛋白质稳定性的优化对于生物制品的研发、生产、储存和临床应用都至关重要，因此，对突变诱导的蛋白质稳定性变化进行有效预测，在生物产业中也具有重要的应用价值。
  
  蛋白质的热力学稳定性通常用其折叠状态与去折叠状态之间的自由能差（ΔG）来表示，这一性质由蛋白质结构内部的残基间相互作用以及蛋白质与水溶液之间的相互作用共同决定。
  
  当某个氨基酸残基发生突变时，涉及该突变残基的相互作用将被改变，从而导致蛋白质热力学稳定性的变化（ΔΔG）。
  
  通过实验手段评估突变对蛋白质稳定性的影响，往往成本高昂且耗时较长。特别是，在蛋白质稳定性优化过程中通常需要筛选大量可能的突变，因此进行全面的实验测量几乎是不可能完成的任务。
  
  计算方法，如分子动力学（MD）模拟、基于经验势能的计算方法以及机器学习（ML）模型，为实验研究提供了有力的补充手段，可用于表征蛋白质稳定性的变化。这些计算方法相对更快，还能用于预测那些难以甚至无法通过实验研究的突变效应。其中，分子动力学模拟结合分子力学-广义伯恩表面积（MMGBSA）或自由能微扰（FEP）方法已被广泛用于计算突变引起的蛋白质稳定性变化，而FEP方法被认为是目前最精确的计算方法之一。
  
  然而，MD模拟需要消耗大量的计算资源。基于经验势能的方法（例如 FoldX 和 Rosetta ）计算效率更高，通常用于大规模突变筛选，但这类方法的预测精度有限。
  
  随着人工智能的快速发展，许多基于机器学习（ML）模型、计算成本较低且有效的预测方法已被提出，用于预测突变对蛋白质热力学稳定性的影响 。在这些基于机器学习的方法中，已应用了多种算法，从经典的决策树、随机森林、支持向量机和人工神经网络，到最新的深度学习方法。这些预测方法所利用的信息包括蛋白质序列、分子进化信息、三级结构、物理与统计能量项，或它们的组合，其中大多数领先的基于机器学习的模型都考虑了三维结构及其相关特征。
  
  基于机器学习的方法在提取决定点突变引起蛋白质稳定性变化的关键信息方面表现出强大能力。然而，这些方法的性能依赖于大量高质量的实验数据用于模型训练。遗憾的是，目前可用训练数据集中的样本数量仍然有限，例如最常用的 Q3421 数据集；因此，许多已发表的用于预测突变诱导稳定性变化的机器学习方法容易出现过拟合问题。这些方法仅在与训练集中的突变相似的案例上表现良好，但难以很好地泛化到未见过的蛋白质结构上。
  
  此外，现有的实验数据集存在不平衡问题，其中以去稳定化（destabilizing）的突变案例占主导，导致大多数基于机器学习的预测方法也存在偏差。在测试数据集中，这些方法对逆向突变（如将突变体恢复为野生型）的预测性能往往不如对正向突变（野生型到突变体）的预测。因此，开发一个具有良好泛化能力和无偏性的机器学习模型，虽然极具吸引力，但也面临巨大挑战。
  
  我们设计了一种名为mutDDG-SSM的新型深度学习框架，用于预测氨基酸残基突变引起的蛋白质稳定性变化。在我们的方法中，通过使用图注意力网络（GAT）结合自监督学习方案，从大量已知蛋白质结构中提取了残基与其周围邻近残基相互作用所蕴含的关键特征。自监督学习过程中的任务是预测给定扰动蛋白质的原始构象，其中某个残基的侧链被随机旋转。通过这种方式，模型能够提取残基间内在的原子级相互作用信息。随后，将学习到的特征表示输入到极端梯度提升（XGBoost）模型中，用于预测残基突变对蛋白质稳定性的影响。
  
  在我们的mutDDG-SSM方法中，原子级表征是从跨不同类别的大规模未标记蛋白质结构中学习得到的。这些学习到的表征可用于多种下游任务，不仅限于蛋白质稳定性预测，还包括蛋白质-蛋白质结合亲和力预测等。利用大量蛋白质结构进行自监督学习，有助于避免以往报道模型常面临的过拟合和数据不平衡问题。此外，在后续训练阶段使用的XGBoost模型相比其他机器学习模型也具有更强的抗过拟合能力。这些设计使得我们的方法具备更好的泛化能力和无偏性。
  
  在多个广泛使用的独立数据集（Ssym 、S350 、S611 、S276  和 S669 ）上的测试结果表明，与其他对比方法相比，我们的方法在正向突变及其对应逆向突变上的预测均表现出最优的无偏性能之一。鉴于自然界中大多数蛋白质突变是单核苷酸变异（SNVs），且这类突变通常与人类疾病相关，我们还进一步评估了mutDDG-SSM在SNV和非SNV突变分类任务中的表现。此外，以肌红蛋白（myoglobin）和p53蛋白为案例研究，进一步展示了mutDDG-SSM在预测突变诱导蛋白质稳定性变化方面的有效性与无偏性。
## 方法
### mutDDG-SSM 架构
  如图1所示，框架由两部分组成：蛋白质结构特征提取器 和 突变诱导的蛋白质稳定性变化预测器 
  
  （GAT 部分只输入和预测器不同数据集的蛋白的三维结构，自监督学习，预测器部分用简单的XGBoost，小数据量不容易过拟合）
![](https://cloudflare.remsait.com/img/ddgssm-a202509201258849.png)
![](https://cloudflare.remsait.com/img/mutdddssm-b202509201259508.png)
#### 蛋白质结构特征提取器
  采用图注意力网络（Graph Attention Network, GAT）作为特征提取器。GAT 在提取几何特征方面表现出色，能够有效捕捉蛋白质结构中原子或残基之间的空间关系和相互作用模式。
  
  为了使 GAT 能够学习到蛋白质内部残基间固有的相互作用表征，我们设计了一种自监督学习方案对其进行预训练。该训练过程不依赖实验稳定性标签，而是通过构造结构扰动任务（如随机旋转侧链）并让模型恢复原始构象，从而学习到结构内在的物理和几何规律
#### 稳定性变化预测器
  将预训练 GAT 模型提取到的几何表征（geometric representations）作为输入，送入框架的第二部分，用于预测单个残基突变所引起的蛋白质稳定性变化（ΔΔG）。
  
  该部分采用 XGBoost（极端梯度提升）模型作为预测器，主要因其在处理中小规模数据时具有较强的泛化能力，并且相比深度神经网络更不容易发生过拟合，特别适合在有限的带标签实验数据上进行训练。
### 自监督学习方案的任务设计
  为了学习编码蛋白质结构中残基与其周围邻近原子相互作用的内在特征，我们设计了一种自监督学习方案。该方案使用了大规模、非冗余且高分辨率的蛋白质结构数据集进行训练。
  
  对于给定的蛋白质结构，随机选择一个残基，并对其侧链进行扰动；自监督学习的任务是：根据扰动后的结构，预测该残基在原始蛋白质中的构象。通过这种方式，模型能够捕捉到蛋白质结构中残基与其周围环境之间原子相互作用所依赖的关键几何特征。
  
  具体而言，在残基扰动过程中，被扰动残基的侧链二面角（torsion angles） 的取值是根据 Dunbrack 骨架依赖型侧链构象库（backbone-dependent rotamer library）提供的概率分布进行采样的。Dunbrack 构象库是通过对大量天然蛋白质结构的统计分析得出的，它提供了在给定主链二面角（φ 和 ψ）条件下，某一残基侧链二面角的可能取值及其出现概率。基于该构象库，我们在蛋白质结构中随机改变某个残基的构象，使其转变为一个新的侧链构象。
  
  自监督学习的任务就是：基于这个被扰动后的构象，让模型预测出该残基原本的、未被扰动时的真实构象。对于甘氨酸（Glycine）和丙氨酸（Alanine），由于它们的侧链仅由氢原子或甲基组成，空间构象变化不显著，因此在这类残基上不进行侧链扰动，其原始构象保持不变。
### 通过图注意力网络模型的自监督学习方案进行表征提取
  采用图注意力网络（GAT）模型进行自监督学习，以捕捉编码蛋白质结构中残基间相互作用的几何特征。GAT 模型将蛋白质结构描述为图结构，其中结构中的原子被表示为节点，原子之间的相互作用被表示为边。
  
  该模型的注意力机制使得节点的特征能够通过其邻近节点的特征进行更新，并对不同邻居赋予不同的权重。GAT 模型已广泛应用于生物信息学研究，例如蛋白质-蛋白质结合预测 、蛋白质-配体相互作用预测以及蛋白质功能预测 。
  
  具体而言，对于一个含有被扰动残基的蛋白质结构，首先构建一个图，其中蛋白质中的原子被表示为节点，原子之间的相互作用通过边进行简化表示。在构建图时，仅考虑结构中的重原子（heavy atoms），包括碳（C）、氮（N）、氧（O）和硫（S）。此外，为了降低计算复杂度，只纳入距离被扰动残基中心 12.0 Å 范围内的所有原子用于构建图。
  
  如果某个残基只有部分原子落在 12.0 Å 范围内，则该残基的所有原子都会被保留在图中，以确保残基结构的完整性。当两个节点之间的距离小于某一阈值时（本文采用 3.0 Å），即认为它们之间存在一条边。
  
  图中的每个节点都附有描述原子属性的特征（attributes）。在本研究中，每个节点使用一个 36 维的特征向量，包含以下信息：（**少1维？**
1. 原子类型，即碳（C）、氮（N）、氧（O）或硫（S），采用独热编码（one-hot encoding）表示；（4维
2. 该原子所属的氨基酸类型，使用20维的独热编码表示（对应20种标准氨基酸）；（20维
3. 该原子所处的DSSP二级结构类型，包括：α-螺旋（alpha-helix）、孤立β桥残基（isolated beta-bridge residue）、β-折叠链（strand）、3₁₀-螺旋（310-helix）、π-螺旋（pi-helix）、转角（turn）、弯曲（bend）或无（none），也采用独热编码表示；（8维
4. 一个表示该原子是否为被扰动原子的独热编码（即是否属于被扰动的残基）；（1维
5. 一个二值属性，表示该原子的溶剂可及表面积（SASA） 是否大于0（大于0记为1，否则记为0）（1维
6. 一个二值特征，表示该原子是否为Cα原子（是则记为1，否则记为0）。（1维

  将通过残基扰动从蛋白质结构中构建出的节点特征和边关系输入到图注意力网络（GAT）模型中。GAT 使用自注意力机制来更新节点特征。归一化的注意力系数是根据文献（图注意力网络）中描述的公式计算得到的。随后，基于这些归一化的注意力系数，通过对邻近节点的特征进行加权求和，来更新当前节点的特征表示。
  
  在本研究中，自注意力层采用了多头注意力机制（multi-head attention），其中每一层的输出特征表示是由 8 个独立的自注意力操作 的输出拼接而成。为了更有效地提取编码蛋白质结构中残基间相互作用的表征，模型堆叠了 4 层八头注意力层，并将第3层和第4层的输出表征进行拼接，作为最终的几何特征表示。
  
  基于GAT模型提取的几何表征，采用了一个三层感知机网络来预测蛋白质中被扰动残基的原始构象。考虑到直接预测原子坐标的绝对值会增加预测难度，本模型的目标是预测原子在扰动后位置与原始位置之间的偏差，该偏差表示为 
  $$\Delta d_{i}=M L P\left(\vec{g}_{i}\right)$$   
  
  其中 $\Delta d_i$ 表示被扰动原子 i 相对于其天然位置的预测偏差，$\vec{g}_{i}$ 是原子 i 的几何表征，MLP 表示多层感知机网络。被扰动原子 i 的真实偏差值记为 $\Delta d_i^{real}$ ，通过扰动构象之间原子坐标的标准均方根偏差（RMSD）计算得到。
  
  然后，该GAT模型在自监督学习中的损失函数被定义为被扰动原子的预测偏差与真实偏差之间的均方误差（Mean Square Error, MSE），其表达式为：
  $$L=\frac{1}{N_{p}} \sum_{i \in N_{p}}\left(\Delta d_{i}-\Delta d_{i}^{\text {real }}\right)^{2}$$
  其中，$N_p$ 表示被扰动残基中的原子数量。GAT 模型在 PyTorch 和 PyTorch Geometric 框架下实现。
  
  综上所述，基于图注意力网络（GAT）模型的自监督学习方案，从大规模非冗余的蛋白质结构中提取出了编码残基间相互作用的几何表征。
### 基于极端梯度提升模型（XGBoost）预测突变诱导的蛋白质稳定性变化
  基于自监督学习方案提取的几何表征，采用 XGBoost 模型来预测残基突变引起的蛋白质稳定性变化。与其它机器学习模型相比，XGBoost 模型在防止过拟合方面表现出良好的性能。
  
  首先，利用训练好的自监督GAT模型，分别生成原始蛋白质及其突变体的几何表征。每个原子的几何表征取自GAT模型的第三和第四注意力层。突变残基中所有原子的表征，以及距离突变残基中心12.0 Å半径范围内的其他原子的表征被提取并表示如下。
```latex
$\{{\vec{h_i}^{(L)},i\in A_{mo}}\},\{{\vec{h_j}^{(L)},j\in A_{no}}\},\{{\vec{h_k}^{(L)},k\in A_{mm}}\},\{{\vec{h_l}^{(L)},l\in A_{nm}}\}$
```
  
  