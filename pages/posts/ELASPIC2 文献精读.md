---
layout: post
title: ELASPIC2 文献精读
date: 2025-10-03 19:26:38
updated: 2025-10-03
time_warning: true 
cover: 
top: 
tags: 
 - ddg
categories: 
 - 生物信息
# author: @Remsait
---
# ELASPIC2 (EL2)：结合上下文化的语言模型和图神经网络来预测突变效应
  [ELASPIC2 (EL2): Combining Contextualized Language Models and Graph Neural Networks to Predict Effects of Mutations](https://doi.org/10.1016/j.jmb.2021.166810)
  
  （感觉用处不大。。。。。
## 摘要
  ELASPIC网络服务器允许用户在全蛋白质组范围内评估突变对蛋白质折叠和蛋白质-蛋白质相互作用的影响。它使用了为多个蛋白质组预先计算的蛋白质及蛋白质-蛋白质相互作用的同源模型，以及整合了结构信息与序列保守性评分的机器学习模型来进行预测。自ELASPIC网络服务器最初发布以来，几项进展促使我们重新审视突变效应预测这一问题。首先，神经网络架构和自监督预训练技术的进步催生了能够提供比原始ELASPIC版本所用模型更丰富信息的蛋白质序列和结构嵌入表示的新模型。其次，训练数据量已增长数倍，这主要得益于深度突变扫描和其他多重变异效应检测技术的进步。本文中，我们描述了两种利用上述最新进展的机器学习模型，以在预测突变对蛋白质折叠和蛋白质-蛋白质相互作用的影响方面实现更高的准确性。这些模型整合了基于预训练的Transformer和图卷积神经网络生成的特征，并通过优化排序目标函数进行训练，从而能够利用异构的训练数据。新模型的输出结果已被整合到ELASPIC网络服务器中，该服务器可通过 http://elaspic.kimlab.org 访问。
## 引言
  DNA测序技术的进步已大幅降低了高通量测序的成本，并显著提高了其准确性。然而，如何解读由此产生的海量基因组数据，以获得有意义且可操作的结果，仍然是一个挑战。

  体内（in vivo）和体外（in vitro）实验技术仍是阐明编码DNA序列变异在蛋白质水平上效应的金标准。然而，要通过实验手段逐一评估所有已发现的变异体，无论是在时间还是所需资源方面都是不可行的。因此，已开发出许多计算工具，用于预测不同变异体的效应，并对它们进行优先级排序，以供后续实验验证。

  大多数工具依赖于某种形式的保守性评分来进行预测，该评分描述了在特定结构域、蛋白质或基因组水平的序列比对中，某个特定核苷酸或氨基酸在给定位置出现的频率。然而，尽管这些基于序列的工具在预测突变有害性方面可能较为成功，但它们对于某个特定突变如何产生其效应，提供的解释非常有限。目前也存在一些基于结构的工具，用于预测突变对蛋白质稳定性以及蛋白质相互作用亲和力的影响，这些工具有助于构建解释特定突变效应的机制模型。然而，大多数基于结构的工具需要用户提供蛋白质或蛋白质复合物的结构，这就将寻找蛋白质结构以及（可能受影响的）蛋白质-蛋白质相互作用结构的负担转嫁给了用户。

  ELASPIC、Mechismo以及类似的工具已被开发出来，旨在促进在蛋白质-蛋白质相互作用网络背景下对突变进行结构分析和解读，从而实现对数千个突变的高通量评估。ELASPIC利用序列谱和同源建模，这些模型已针对人类蛋白质组中所有蛋白质及已知的蛋白质-蛋白质相互作用预先计算完成，而对于非人类蛋白质则可实时计算，用以预测突变所引起的蛋白质折叠和结合吉布斯自由能的变化。在多项独立评估中，ELASPIC的预测结果与其他方法相比表现优异。

  在此，我们推出了两种新的机器学习模型：ELASPIC2核心模型（EL2core） 和 ELASPIC2界面模型（EL2interface）。它们分别能够更准确地预测突变引起的蛋白质稳定性和蛋白质结合亲和力的变化，同时比现有方法快一个数量级以上，并且不依赖外部数据库或专有软件。新模型利用两种预训练神经网络——ProteinSolver 和 ProtBert，对单个突变进行特征化表示，并采用梯度提升决策树（GBDT） 机器学习算法，结合排序目标函数进行训练，从而能够整合来自不同体内（in vivo）和体外（in vitro）实验技术获得的数据。新模型在交叉验证和独立测试集上的预测结果均表现出与实验测量值高度一致的相关性，优于其他现有方法。这些新模型已集成至ELASPIC网络服务器中。此外，我们还提供了REST API、交互式笔记本（interactive notebooks）以及独立运行的软件包，以促进EL2模型在各类应用场景中的广泛使用。
## 结果与讨论
### 数据准备
  我们收集了一系列多样化的数据集，其中列出了突变对与蛋白质稳定性（表1）或蛋白质结合亲和力（表2）相关的指标所产生的影响。除了用于训练原始ELASPIC模型的ProTherm和SKEMPI数据集外，我们收集的数据集还包括一组扩展的ΔΔG（ddG）和Tm测量值，由Dunham等人整理的20项体内和体外深度突变扫描（deep mutation scanning）实验结果（报告了突变对蛋白质折叠或结合的影响），以及经过人工整理的、映射到蛋白质结构或蛋白质-蛋白质相互作用界面的有害（deleterious）和良性（benign）突变数据集。尽管并非所有有害突变都会降低蛋白质或蛋白质-蛋白质相互作用的稳定性，但我们认为其中很大一部分确实具有这种效应。

  我们对数据集进行了清洗：移除了在特定数据集中突变数量少于三个且具有唯一实验测量值的蛋白质，并去除了突变有害性数据集中的冗余序列。该过程最终生成了一个包含超过25万个与蛋白质稳定性变化相关突变的训练数据集（表1），以及一个包含超过5万个与蛋白质结合亲和力变化相关突变的训练数据集（表2）。

  我们使用MMSeqs2将训练数据集中的蛋白质序列按最多30%的序列一致性划分为不同的聚类，并创建了六个训练-测试分割方案，用于交叉验证，确保训练集和测试集中的序列属于不同的聚类。此外，我们构建了一个独立的测试数据集，其中列出了3,749个突变对SARS-CoV-2刺突蛋白（spike protein）稳定性的影响，以及3,669个突变对其与人ACE2受体结合亲和力的影响。

  我们使用ProteinSolver和ProtBert为训练数据集中的每个突变生成描述性特征（详见方法部分）。同时，我们还使用Rosetta对每个突变进行了评估，并对除Rocklin (2017)、SKEMPI 2.0和Dunham (2020)数据集之外的所有突变，使用了ELASPIC和FoldX进行评估。对于测试数据集，除了ELASPIC、FoldX和Rosetta外，我们还使用了Provean、mCSM、PoPMuSiC、SIFT和PolyPhen-2网络服务器生成了预测结果，以便进行全面的性能比较。
### 模型训练与评估
  我们将训练数据集中的所有突变按其所影响的蛋白质以及可用的实验测量类型进行分组，并使用 LightGBM 实现的梯度提升决策树（GBDT）算法，训练模型以根据突变效应对每组内的突变进行正确排序。我们通过超参数调优和特征筛选，选择能够产生最佳性能模型的超参数和特征，模型性能通过六折交叉验证得到的平均斯皮尔曼相关系数（Spearman’s correlation coefficient）进行衡量（见补充图 S1）。在评估模型在测试数据集上的准确性时，我们采用了在交叉验证过程中训练出的六个 EL2core 模型和六个 EL2interface 模型的预测结果的平均值。
  
  图1A和图2A分别展示了使用EL2core和EL2interface模型通过交叉验证得到的预测结果的斯皮尔曼相关系数（Spearman’s correlation coefficients）。作为对比，我们还展示了使用ELASPIC、FoldX、Rosetta、ProteinSolver和ProtBert进行预测的相关系数。对于ProteinSolver和ProtBert，其预测值是通过神经网络为野生型和突变型残基所分配的概率之差来计算的。在除ProTherm和SKEMPI数据集之外的所有数据集上，EL2模型的预测结果与实验测量值之间的相关性均强于其他方法（图1A和图2A）。（对比图省略
  
  在ProTherm数据集上，EL2core模型得到的斯皮尔曼相关系数明显低于ELASPIC、FoldX和Rosetta所得的相关系数；而在SKEMPI数据集上，EL2interface模型的相关系数略低于ELASPIC，但与其他方法的相关系数相当。我们对EL2模型在这两个数据集上表现相对较差的原因提出了两种可能的解释：首先，ProTherm和SKEMPI分别是用于训练或优化预测突变对蛋白质稳定性及蛋白质结合亲和力影响的两个主要数据集，因此现有模型在这两个数据集上很可能表现出过于乐观的结果。这一解释得到了以下观察的支持：EL2core模型在ProTherm数据集上的相关性弱于Rosetta，但在使用高通量稳定性测量的Rocklin (2017) 数据集上，其相关性却强于Rosetta。其次，由于EL2模型的目标之一是能够稳健地应对不同的实验系统和条件，因此我们可能在一定程度上牺牲了精度，以换取比那些专为特定应用场景（例如预测体外ΔΔG值）而优化的方法更强的泛化能力。我们认为，这种权衡是合理的，因为它使得模型的预测结果能够更好地推广到各种不同的实验设置和测量技术中。
  
  在选出交叉验证中表现最佳的EL2模型后，我们进一步在一组独立测试数据集上评估了这些模型的性能。该数据集报告了3,749个突变对SARS-CoV-2刺突蛋白稳定性的影响，以及3,669个突变对SARS-CoV-2刺突蛋白与ACE2受体结合亲和力的影响。作为对比，我们还纳入了使用ELASPIC、FoldX、Rosetta、ProteinSolver、ProtBert、mCSM、PoPMuSiC，以及在稳定性预测中使用的SIFT、PolyPhen-2和Provean所生成的预测结果。EL2模型在这两个独立数据集上均取得了最高的斯皮尔曼相关系数：EL2core（稳定性预测）的相关系数为 0.61（图1C），EL2interface（结合亲和力预测）的相关系数为 0.62（图2C），表明其预测值与实验测量值之间具有最强的相关性。在稳定性数据集上：ProteinSolver的相关系数为0.51，排名第二；ProtBert的相关系数仅为0.01，表现最差；值得注意的是，其他基于序列的工具（如SIFT、PolyPhen-2、Provean）的表现与基于结构的工具（如Rosetta、FoldX、mCSM）相当，相关系数相近（图1C）。这一结果与以往研究一致，即序列工具在预测突变蛋白稳定性方面，准确率与结构工具相当或仅略低。在亲和力数据集上：ELASPIC、FoldX、Rosetta和mCSM的相关系数分别为0.51、0.53、0.54和0.37，均显著低于EL2interface的0.62；ProtBert的相关系数为0，几乎无预测能力（图2C）。
  
  一个值得注意的发现是，ProteinSolver在测试数据集上（图1C和2C）产生的相关性具有竞争力，且通常优于其他方法。这一点令人意外，因为ProteinSolver的训练目标仅仅是根据蛋白质的整体拓扑结构来重建被掩码氨基酸的身份，并不包含任何关于蛋白质-蛋白质相互作用的信息。相比之下，ProtBert在反映突变有害性的数据集（如Humsavar、ClinVar和COSMIC）上表现出更高的相关性（图1A和1C），这与其作为序列模型的训练方式一致——它是在与可存活生物相关的蛋白质序列上训练的，旨在重建被掩码的氨基酸。目前尚不清楚为何ProtBert在SARS-CoV-2测试数据集上的相关性显著弱于其他基于序列的方法。一种可能的解释是：用于训练ProtBert的BFD数据库中，病毒蛋白序列的比例极低，导致其在病毒蛋白（如SARS-CoV-2刺突蛋白）上的泛化能力较差。
  
  ELASPIC 的一个明确目标是提供关于突变在生物体蛋白质-蛋白质相互作用网络背景下的效应的机制性洞察。因此，我们力求将 ELASPIC 和 EL2 与 Mechismo 进行比较，后者是另一种专门为实现这一目标而设计的工具。然而，Mechismo 的网络服务器仅能评估来自八种预设生物体之一的蛋白质中的突变。由于 SARS-CoV-2 不在这八种生物体之中，我们无法使用先前的 SARS-CoV-2 独立测试集来进行此项比较。作为替代方案，我们选择使用 Dunham 等人 (2020) 亲和力数据集中的突变进行对比分析，该分析结果展示于补充图 S2中。在我们评估的所有方法中，Mechismo 是最快的，能在数秒内完成数千个突变的评分。其 mech、mechProt 和相互作用效应（IE）模型的表现与其他参与比较的模型相当（补充图 S2）。然而，EL2interface 模型在整体上表现最佳，在五个实验中的四个实验里取得了最高的斯皮尔曼相关系数（补充图 S2A）。这表明，尽管 Mechismo 速度极快且机制解释性强，EL2interface 在预测突变对蛋白质结合亲和力影响的准确性方面仍具有优势。
  
  值得强调的是，EL2模型评估突变影响的速度比依赖结构建模的ELASPIC及其他方法快一到两个数量级——EL2评估单个突变仅需数秒，而非数分钟甚至数小时。此外，尽管我们在训练数据集中为每个蛋白质都获取了晶体结构或构建了同源建模结构，但我们用于生成输入特征的两个核心工具——ProteinSolver 和 ProtBert——并不需要精细的蛋白质三维结构信息或蛋白质相互作用的详细结构数据。ProteinSolver 和 ProtBert 的输入仅为蛋白质的氨基酸序列；在结合亲和力预测任务中，还需提供其相互作用伙伴的序列；此外，ProteinSolver 还需要一个粗粒度的距离矩阵作为输入，该矩阵列出了所有在12Å范围内的残基对之间的最短路径距离。关键优势在于：该距离矩阵可以通过将序列比对映射到结构模板上获得，而无需构建完整的同源模型（这正是ProteinSolver训练数据的生成方式）。这一策略规避了在全蛋白质组尺度上预测突变效应时最耗时的计算环节，从而实现了高效、可扩展的突变效应预测。
### Web server and other interfaces
略
## 结论
  在本研究中，我们提出了 EL2core 和 EL2interface 两种机器学习模型，分别用于预测突变对蛋白质折叠稳定性和蛋白质-蛋白质相互作用的影响。我们已将这两个EL2模型的预测功能整合至ELASPIC网络服务器，并同时提供REST API、交互式笔记本（interactive notebooks） 以及独立运行的软件包，以便在多种应用场景中便捷地使用这些模型。与现有方法相比，EL2模型在评估突变效应时速度快出几个数量级，同时在预测深度突变扫描实验结果方面，其准确性达到或超过了当前最先进的工具。对于新模型准确性的最终检验，将是来自独立第三方的评估，例如基因组解释关键评估（Critical Assessment of Genome Interpretation, CAGI） 社区实验。我们计划在未来积极参与此类评估，以进一步验证EL2模型的预测能力。
## 材料与方法
### 数据准备
  用于训练、验证和测试 EL2core 与 EL2interface 模型的数据集分别列于表1和表2中。对于每个数据集，我们收集了以下信息：蛋白质序列；蛋白质结构；突变列表；突变的实验测量效应值（如 ΔΔG、Tm 变化、功能评分等）。在目标蛋白无可用PDB结构的情况下，我们基于其蛋白质序列构建了相应的同源模型（homology models）以补充结构信息。为确保模型训练的稳定性与可靠性，我们进行了以下数据过滤：
  
  剔除突变数据不足的蛋白质：若某蛋白质在特定数据集中具有唯一实验测量值的突变少于3个，则将其从该数据集中移除。这是因为本研究采用的 lambdarank 目标函数（排序学习目标）在每组训练样本数量较多时表现更稳健。
  
  避免数据重复与泄露：若某蛋白质已存在于 Humsavar 数据集中，则从 ClinVar 数据集中排除该蛋白质；若某蛋白质已存在于 Humsavar 或 ClinVar 数据集中，则从 COSMIC 数据集中排除该蛋白质。
### 特征工程
  我们使用了两个预训练的神经网络模型ProteinSolver和ProtBert，来生成描述每个蛋白质或蛋白质-蛋白质相互作用及其突变的特征。在预测突变对蛋白质稳定性的影响时，我们利用ProteinSolver和ProtBert获取野生型和突变型残基的概率，并使用ProtBert获得野生型与突变型残基以及整个蛋白质的特征嵌入，其中蛋白质的嵌入对应于所有残基嵌入向量的逐元素之和。在预测突变对蛋白质结合亲和力的影响时，我们采用了相同的特征，但分别针对蛋白质单独存在以及与相互作用伙伴结合的状态进行计算。我们在上述方法得到的特征基础上进行了扩展，加入了野生型与突变型蛋白之间的特征差异值，以及在适用情况下，蛋白质单独状态与其结合状态之间的特征差异值。最后，对于残基和蛋白质的嵌入向量及其差异，我们采用主成分分析（PCA）将1024维的向量降维至10个特征，即前10个主成分。
  
  对于训练数据集中的每个突变，我们生成了“反向”突变，即将突变残基恢复为野生型残基，并利用这些反向突变来平衡训练数据集，缓解了 destabilizing 突变（降低稳定性的突变）在数据中过度代表的问题。这些“反向”突变的效应被假定为与原始突变的效应在数值上相等但方向相反。
### 机器学习
  我们使用了在 LightGBM 中实现的梯度提升决策树（GBDT）算法，根据输入特征预测突变对蛋白质稳定性及蛋白质结合亲和力的影响。与原始 ELASPIC 模型通过最小化预测值与实际 ΔΔG 值之间的均方根偏差进行训练不同，EL2 模型采用 lambdarank 目标函数进行优化，该函数旨在使模型对某一组内所有突变对所分配的评分顺序，与这些突变在实验指标下的相对排序保持一致。公式（1）体现了 lambdarank 目标函数的核心思想，其中 C 表示代价，$s_i$ 和 $s_j$ 分别表示模型为突变 i 和突变 j 分配的评分，$S_{ij}$ 在突变 i 的实验排名高于突变 j 时为 1，否则为 0。当所有 $S_{ij}$ = 1 的突变对满足 $s_i$ > $s_j$，且所有 Sij = 0 的突变对满足 $s_i$ < $s_j$ 时，代价达到最低。
$$C=\frac{1}{2}\left(1-S_{i j}\right) \sigma\left(s_{i}-s_{j}\right)+\log \left(1+\exp \left(-\sigma\left(s_{i}-s_{j}\right)\right)\right)$$
  我们通过超参数优化和特征筛选，寻找能够使模型在交叉验证中产生最高斯皮尔曼相关系数的超参数组合和特征集合。超参数优化使用 optuna 框架进行，共选择并评估了 100 组超参数。在每轮特征筛选过程中，我们通过临时从训练集中逐一排除每个特征，训练模型，并通过交叉验证评估模型性能，从而确定应移除的特征，最终保留使模型性能最高的特征组合（见补充图 S1）。最终的 EL2core 模型使用了 17 个特征（补充表 S2），而最终的 EL2interface 模型使用了 16 个特征（补充表 S3）。

  
